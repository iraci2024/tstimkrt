/*!
**************************************************************************
 sgcWebSocket component

 written by eSeGeCe
            copyright Â© 2021
            Email : info@esegece.com
            Web : http://www.esegece.com
**************************************************************************
*/

function sgcws_presence(){function e(n){for(var s in n)"object"==typeof n[s]&&e(n[s]),n[s].length>0&&(n[s]=sgcDecodeB64(n[s]));return n}if(0!=arguments.length){1==arguments.length?"object"==typeof arguments[0]?(arguments[0].subprotocol="presence.esegece.com",sgcWebSocket.call(this,arguments[0])):"string"==typeof arguments[0]&&(arguments[1]="presence.esegece.com",sgcWebSocket.call(this,arguments[0],arguments[1])):2==arguments.length?"object"==typeof arguments[0]?(arguments[0].subprotocol=arguments[1]+"presence.esegece.com",sgcWebSocket.call(this,arguments[0])):"string"==typeof arguments[0]&&(arguments[1]=arguments[1]+"presence.esegece.com",sgcWebSocket.call(this,arguments[0],arguments[1])):3==arguments.length&&("object"==typeof arguments[0]?(arguments[0].subprotocol=arguments[1]+"presence.esegece.com",arguments[0].transport=arguments[2],sgcWebSocket.call(this,arguments[0])):"string"==typeof arguments[0]&&(arguments[1]=arguments[1]+"presence.esegece.com",sgcWebSocket.call(this,arguments[0],arguments[1],arguments[2])));var n=new Object;n.id="",n.name="",n.info="";var s=new Object;s.name="";var c=new Object;c.text="";var m=new Object;m.text="";var r=this.send;this.send=function(e,n,s,c){arguments[0]='{"jsonrpc":"2.0", "method":"'+sgcEncodeB64(e)+'"',void 0!==n&&(arguments[0]=arguments[0]+', "member":{"id":"'+sgcEncodeB64(n.id)+'","name":"'+sgcEncodeB64(n.name)+'","info":"'+sgcEncodeB64(n.info)+'"}'),void 0!==s&&(arguments[0]=arguments[0]+', "channel":{"name":"'+sgcEncodeB64(s.name)+'"}'),void 0!==c&&(arguments[0]=arguments[0]+', "message":{"text":"'+sgcEncodeB64(c.text)+'"}'),arguments[0]=arguments[0]+"}",r.apply(this,arguments)},this.newmember=function(e,s,c){n.id=e,n.name=s,void 0!==c?n.info=c:n.info="",this.send("sgc@presence@member@new",n)},this.removemember=function(){this.send("sgc@presence@member@remove",n)},this.publish=function(e,m){s.name="",void 0!==m&&(s.name=m),c.text="",void 0!==e&&(c.text=e),this.send("sgc@presence@publish@msg",n,s,c)},this.subscribe=function(e){s.name=e,this.send("sgc@presence@channel@member@new",n,s)},this.unsubscribe=function(e){s.name=e,this.send("sgc@presence@channel@member@remove",n,s)},this.getmembers=function(e){s.name="",void 0!==e&&(s.name=e),this.send("sgc@presence@get@members",n,s)};var o=new event("onsgcsession"),b=new event("onsgcnewmember"),t=new event("onsgcremovemember"),g=new event("onsgcnewchannelmember"),i=new event("onsgcremovechannelmember"),a=new event("onsgcpublishmsg"),h=new event("onsgcgetmembers"),l=new event("onsgcerrormemberchannel"),p=new event("onsgcerrorpublishmsg");DoEventMessage=function(n){var s=n.data;obj=e(JSON.parse(s)),void 0!==obj.method&&("sgc@presence@session"==obj.method?o.fire({name:"onsgcsession",id:obj.message.text}):"sgc@presence@member@new"==obj.method?b.fire({name:"onsgcnewmember",member:obj.member}):"sgc@presence@member@remove"==obj.method?t.fire({name:"onsgcremovemember",member:obj.member}):"sgc@presence@channel@member@new"==obj.method?g.fire({name:"onsgcnewchannelmember",member:obj.member,channel:obj.channel}):"sgc@presence@channel@member@remove"==obj.method?i.fire({name:"onsgcremovechannelmember",member:obj.member,channel:obj.channel}):"sgc@presence@publish@msg"==obj.method?a.fire({name:"onsgcpublishmsg",member:obj.member,channel:obj.channel,message:obj.message}):"sgc@presence@send@members"==obj.method?h.fire({name:"onsgcgetmembers",members:obj.members,member:obj.member,channel:obj.channel}):"sgc@presence@error@member@channel"==obj.method?l.fire({name:"onsgcgetmembers",error:obj.error,member:obj.member,channel:obj.channel}):"sgc@presence@error@publish@msg"==obj.method&&p.fire({name:"onsgcerrorpublishmsg",error:obj.error,message:obj.message,member:obj.member,channel:obj.channel}))};var d=this.on;this.on=function(e,n){"sgcsession"==e?o.subscribe(n):"sgcnewmember"==e?b.subscribe(n):"sgcremovemember"==e?t.subscribe(n):"sgcnewchannelmember"==e?g.subscribe(n):"sgcremovechannelmember"==e?i.subscribe(n):"sgcpublishmsg"==e?a.subscribe(n):"sgcgetmembers"==e?h.subscribe(n):"sgcerrormemberchannel"==e?l.subscribe(n):"sgcerrorpublishmsg"==e?p.subscribe(n):d.apply(this,arguments)}}}sgcws_presence.prototype=new sgcWebSocket,sgcws_presence.prototype.constructor=sgcws_presence;