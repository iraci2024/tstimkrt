<html>
<head>
   <title>AddFiles</title>
<object type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
<param name="alink name" value="TFlexCompress_AddFiles;AddFiles_Method;AddFiles">
<param name="alink name" value="$topicid_AddFiles">
</object><object id=hhctrl_1 type="application/x-oleobject" classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11"><param name="Command" value="ALink"><param name="Window" value="Example"><param name="Item1" value=""><param name="Item2" value="$topicid_BasicExample"></object><object id=hhctrl_2 type="application/x-oleobject" classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11"><param name="Command" value="ALink"><param name="Window" value="Example"><param name="Item1" value=""><param name="Item2" value="$topicid_AdvancedExample"></object></head>

<body bgcolor="#FFFFFF">


<table width="100%" border="0" cellspacing="0" cellpadding="2" bgcolor="#FFFFFF">
  <tr>
    <td align="left">
      
<span style="font-family:Helvetica,Arial; font-size:12pt; color:#000000"><b>T</b><b>FlexCompress</b><b>.AddFiles</b><span style="font-family:Helvetica,Arial; font-size:6pt; color:#000000">
<br>
</span><span style="font-family:Helvetica,Arial; font-size:8pt; color:#000000"><a href=tflexcompress.htm>TFlexCompress</a></span><span style="font-family:Helvetica,Arial; font-size:12pt; color:#000000"><b> &nbsp;&nbsp;&nbsp;</b></span><span style="font-family:Helvetica,Arial; font-size:8pt; color:#000000"><a href=javascript:hhctrl_1.hhclick()>Example1</a></span><span style="font-family:Helvetica,Arial; font-size:12pt; color:#000000"><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</b></span><span style="font-family:Helvetica,Arial; font-size:8pt; color:#000000"><a href=javascript:hhctrl_2.hhclick()>Example2</a></span><span style="font-family:Helvetica,Arial; font-size:12pt; color:#000000"><b>
<br>
</b></span></span>
    </td>
    <td align="right">
     <font face="Arial" size="2">
     
     <a href="overview.htm">Top</a>&nbsp;
     
     </font>
    </td>
  </tr>
</table>
<br><br>



<span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000">Adds files to the archive.<b>
<br>
</b><b>
<br>
procedure </b>AddFiles;<b> overload;
<br>
procedure </b>AddFiles(
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FileMask:&nbsp;&nbsp;&nbsp;WideString;
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SearchAttr: &nbsp;&nbsp;&nbsp;Word = faAnyFile-faDirectory;
<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ExclusionMask: WideString = '');<b> overload;
<br>

<br>
</b><b>Description</b>
<br>
Use AddFiles to add files to the <a href=openarchive.htm>open</a> archive file. If you need to delete source files, use <a href=movefiles.htm>MoveFiles</a> instead of AddFiles. If <a href=options.htm>Options</a>.Recurse is set to True, AddFiles will search files recursively.
<br>
&nbsp;&nbsp;&nbsp;
<br>
AddFiles variant without parameters uses <a href=filemasks.htm>FileMasks</a>, <a href=exclusionmasks.htm>ExclusionMasks</a> and <a href=options.htm>Options</a>.SearchAttr to specify search conditions and to exclude files from add operation.
<br>

<br>
The FileMask parameter is the directory and file name mask, including wildcard characters. For example, 'C:\TEST\*.*' specifies all files in the C:\TEST directory. All files that meets FileMask and SearchAttr will be added to the archive.
<br>

<br>
The SearchAttr parameter specifies the special files to include in addition to all normal files. This parameter is similar to the Attr parameter in FindFirst function from SysUtils unit. You can set it to any combination of faReadOnly, faHidden, faSysFile, faVolumeID, faDirectory, faArchive constants defined in SysUtils or value faAnyFile meaning that any file meets search condition.
<br>
If you would like to process files without Archive attribute, you should specify $80 constant in addition to other attributes combination.
<br>
You may also need to add the following constants to SearchAttr to include all files on NTFS drive:
<br>

<br>
<table border="0" cellpadding="1" cellspacing="0"><tr><td align="left" valign="top" width="93">
<span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000">Value
<br>
</span></td><td align="left" valign="top" width="447">
<span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000">Description
<br>
</span></td></tr><tr><td align="left" valign="top" width="93">
<span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000">$2000
<br>
</span></td><td align="left" valign="top" width="447">
<span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000">The file is not to be indexed by the content indexing service.
<br>
</span></td></tr><tr><td align="left" valign="top" width="93">
<span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000">$800
<br>
</span></td><td align="left" valign="top" width="447">
<span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000">A file or directory that is compressed. 
<br>
</span></td></tr><tr><td align="left" valign="top" width="93">
<span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000">$4000
<br>
</span></td><td align="left" valign="top" width="447">
<span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000">A file or directory that is encrypted. 
<br>
</span></td></tr><tr><td align="left" valign="top" width="93">
<span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000">$200
<br>
</span></td><td align="left" valign="top" width="447">
<span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000">A file that is a sparse file.
<br>
</span></td></tr></table>
<br>

<br>
The ExclusionMask specifies files to be excluded from add operation.
<br>

<br>
<b>Note:</b>    If you need to add certain files without compression set <a href=nocompressionmasks.htm>NoCompressionMasks</a> property. If some errors occurs an exception will be raised. Write an <a href=onprocessfilefailure.htm>OnProcessFileFailure</a> event handler to perform your own error handling.
<br>

<br>
<b>Note:</b>    If you need to change the name of the added file, use <a href=onstorefile.htm>OnStoreFile</a> event handler.
<br>

<br>
</span>

</body>
</html>
