<html>
<head>
   <title>AddFromStream</title>
<object type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
<param name="alink name" value="TFlexCompress_AddFromStream;AddFromStream_Method;AddFromStream">
<param name="alink name" value="$topicid_AddFromStream">
</object></head>

<body bgcolor="#FFFFFF">


<table width="100%" border="0" cellspacing="0" cellpadding="2" bgcolor="#FFFFFF">
  <tr>
    <td align="left">
      
<span style="font-family:Helvetica,Arial; font-size:12pt; color:#000000"><b>T</b><b>FlexCompress</b><b>.AddFromStream</b><span style="font-family:Helvetica,Arial; font-size:6pt; color:#000000">
<br>
</span><span style="font-family:Helvetica,Arial; font-size:8pt; color:#000000"><a href=tflexcompress.htm>TFlexCompress</a></span><span style="font-family:Helvetica,Arial; font-size:12pt; color:#000000"><b> 
<br>
</b></span></span>
    </td>
    <td align="right">
     <font face="Arial" size="2">
     
     <a href="overview.htm">Top</a>&nbsp;
     
     </font>
    </td>
  </tr>
</table>
<br><br>



<span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000">Adds data stored in a TStream descendant object to the archive.<b>
<br>
</b><b>
<br>
procedure </b>AddFromStream(FileName: WideString; Stream: TStream; CopyToBuffer: Boolean = True; Position: Integer = 0; Count: Integer = 0; Attr: Integer = faArchive; DateTime: TDateTime = 0);<b>
<br>

<br>
Description</b>
<br>

<br>
Use AddFromStream to compress data stored in the TStream descendant object like TFileStream, TMemoryStream or TBlobStream to the file inside the archive. 
<br>

<br>
The FileName parameter specifies file name that will be used to store data from the TStream descendant object.
<br>

<br>
The CopyToBuffer specifies whether to copy data from stream to internal buffer before compressing. Setting CopyToBuffer to true could be useful while adding data from multiple streams in a transaction, where the source streams are destroyed before the EndUpdate call.
<br>

<br>
The Position determines starting position in Stream for adding data to the archive.
<br>

<br>
Count specifies size of the data in Stream for adding to the archive. If Count = 0 size of the data will be Stream.Size - Position. 
<br>
If Count &gt; 0 then AddFromStream copies stream data to the internal memory stream before processing.
<br>
By default all Stream contents will be added to the archive.
<br>

<br>
The Attr parameter specifies file attributes which will be assigned to the stored file.
<br>

<br>
The DateTime parameter specifies file date and time which will be assigned to the stored file.
<br>

<br>
<b>Note:</b>    While using multiple AddFromStream calls within a single transaction, keep in mind that you may get an error if a stream object is destroyed before the call to the <a href=endupdate.htm>EndUpdate</a> method. Please note that you should use separate stream objects for each AddFromStream call if you don't pass Count &gt; 0 parameter.
<br>
</span>

</body>
</html>
