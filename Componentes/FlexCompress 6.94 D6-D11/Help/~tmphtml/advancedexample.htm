<html>
<head>
   <title>AdvancedExample</title>
<object type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
<param name="alink name" value="$topicid_AdvancedExample">
</object></head>

<body bgcolor="#FFFFFF">


<table width="100%" border="0" cellspacing="0" cellpadding="2" bgcolor="#FFFFFF">
  <tr>
    <td align="left">
      
<span style="font-family:Helvetica,Arial; font-size:12pt; color:#000000"><b>Advanced Example
<br>
</b></span>
    </td>
    <td align="right">
     <font face="Arial" size="2">
     
     <a href="overview.htm">Top</a>&nbsp;
     
     </font>
    </td>
  </tr>
</table>
<br><br>



<span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000">The following example shows how to handle the archive file:
<br>

<br>
<b>with</b> Archiver <b>do
<br>
</b>    <b>begin</b>
<br>
        FileName := 'C:\TEST\test.fxc';
<br>
<span style="font-family:Helvetica,Arial; font-size:5pt; color:#000000"> 
<br>
</span><span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000">        <span style="font-family:Helvetica,Arial; font-size:10pt; color:#0000FF"><i>// Create a new archive file</i></span></span><span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000"><span style="font-family:Helvetica,Arial; font-size:10pt; color:#0000FF">
<br>
</span></span><span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000">        OpenArchive(fmCreate);
<br>
</span><span style="font-family:Helvetica,Arial; font-size:5pt; color:#000000"> 
<br>
</span><span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000">        <span style="font-family:Helvetica,Arial; font-size:10pt; color:#0000FF"><i>// Let's encrypt all files</i></span></span><span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000"><span style="font-family:Helvetica,Arial; font-size:10pt; color:#0000FF">
<br>
</span></span><span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000">        Password := 'The password';
<br>
</span><span style="font-family:Helvetica,Arial; font-size:5pt; color:#000000"> 
<br>
</span><span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000">        <span style="font-family:Helvetica,Arial; font-size:10pt; color:#0000FF"><i>// Set path to folder with some text files to BaseDir
<br>
</i></span></span><span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000"><i>        </i>BaseDir := 'C:\SOURCE_FOLDER';
<br>
</span><span style="font-family:Helvetica,Arial; font-size:5pt; color:#000000">  
<br>
</span><span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000">        <span style="font-family:Helvetica,Arial; font-size:10pt; color:#0000FF"><i>// Do not compress MPEG3 files
<br>
</i></span></span><span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000"><i>        </i>NoCompressionMasks.Text := '*.mp3';
<br>
</span><span style="font-family:Helvetica,Arial; font-size:2pt; color:#000000"> 
<br>
</span><span style="font-family:Helvetica,Arial; font-size:5pt; color:#000000"> </span><span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000">       <span style="font-family:Helvetica,Arial; font-size:10pt; color:#0000FF"><i>// Add all files and directories from </i></span></span><span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000"><span style="font-family:Helvetica,Arial; font-size:10pt; color:#0000FF">'C:\SOURCE_FOLDER' </span></span><span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000"><span style="font-family:Helvetica,Arial; font-size:10pt; color:#0000FF"><i>to the archive</i></span></span><span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000">
<br>
        AddFiles('*.*');
<br>
</span><span style="font-family:Helvetica,Arial; font-size:5pt; color:#000000"> 
<br>
</span><span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000">        <span style="font-family:Helvetica,Arial; font-size:10pt; color:#0000FF"><i>// Set path to destination folder</i></span></span><span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000"><i> </i>
<br>
        BaseDir := 'C:\DESTINATION_FOLDER';
<br>
</span><span style="font-family:Helvetica,Arial; font-size:5pt; color:#000000"> 
<br>
</span><span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000">        <span style="font-family:Helvetica,Arial; font-size:10pt; color:#0000FF"><i>// Extract all files and directories from the archive to </i></span></span><span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000"><span style="font-family:Helvetica,Arial; font-size:10pt; color:#0000FF">BaseDir
<br>
        </span></span><span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000">ExtractFiles('*.*');
<br>
</span><span style="font-family:Helvetica,Arial; font-size:5pt; color:#000000"><span style="font-family:Helvetica,Arial; font-size:5pt; color:#0000FF"> 
<br>
</span></span><span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000"><span style="font-family:Helvetica,Arial; font-size:10pt; color:#0000FF">        </span></span><span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000"><span style="font-family:Helvetica,Arial; font-size:10pt; color:#0000FF"><i>// Use full path</i></span></span><span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000">
<br>
        Options.StorePath := spFullPath;
<br>
</span><span style="font-family:Helvetica,Arial; font-size:5pt; color:#000000"> 
<br>
</span><span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000">        <span style="font-family:Helvetica,Arial; font-size:10pt; color:#0000FF"><i>// Move all text files from </i></span></span><span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000"><span style="font-family:Helvetica,Arial; font-size:10pt; color:#0000FF">'C:\SOURCE_FOLDER1' </span></span><span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000"><span style="font-family:Helvetica,Arial; font-size:10pt; color:#0000FF"><i>to the archive</i></span></span><span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000"><span style="font-family:Helvetica,Arial; font-size:10pt; color:#0000FF">
<br>
</span></span><span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000">        MoveFiles('C:\SOURCE_FOLDER1\*.txt',faAnyFile-faDirectory);
<br>
</span><span style="font-family:Helvetica,Arial; font-size:5pt; color:#000000"> 
<br>
</span><span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000">        <span style="font-family:Helvetica,Arial; font-size:10pt; color:#0000FF"><i>// Set path to C:\</i></span></span><span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000">
<br>
        BaseDir := 'C:\';
<br>
</span><span style="font-family:Helvetica,Arial; font-size:5pt; color:#000000"><span style="font-family:Helvetica,Arial; font-size:5pt; color:#0000FF"> 
<br>
</span></span><span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000"><span style="font-family:Helvetica,Arial; font-size:10pt; color:#0000FF">        </span></span><span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000"><span style="font-family:Helvetica,Arial; font-size:10pt; color:#0000FF"><i>// Overwrite all files</i></span></span><span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000">
<br>
</span><span style="font-family:Helvetica,Arial; font-size:5pt; color:#000000">           </span><span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000">  Options.OverwriteMode := omAlways;
<br>
</span><span style="font-family:Helvetica,Arial; font-size:5pt; color:#000000"> 
<br>
</span><span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000">        <span style="font-family:Helvetica,Arial; font-size:10pt; color:#0000FF"><i>// Update all files excluding 1???.t* from </i></span></span><span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000"><span style="font-family:Helvetica,Arial; font-size:10pt; color:#0000FF">'C:\SOURCE_FOLDER1' 
<br>
</span></span><span style="font-family:Helvetica,Arial; font-size:5pt; color:#000000">               </span><span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000">UpdateFiles('SOURCE_FOLDER1\*.*',faAnyFile-faDirectory,'<i>1???.t*</i>');
<br>
</span><span style="font-family:Helvetica,Arial; font-size:5pt; color:#000000"> 
<br>
</span><span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000">        <span style="font-family:Helvetica,Arial; font-size:10pt; color:#0000FF"><i>// Set temporary directory</i></span></span><span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000"><span style="font-family:Helvetica,Arial; font-size:10pt; color:#0000FF">
<br>
</span></span><span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000">        TempDir := 'C:\TEMP';
<br>
</span><span style="font-family:Helvetica,Arial; font-size:5pt; color:#000000"> 
<br>
</span><span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000">        <span style="font-family:Helvetica,Arial; font-size:10pt; color:#0000FF"><i>// Test all files and directories in the archive
<br>
        </i></span></span><span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000"><b>try</b><span style="font-family:Helvetica,Arial; font-size:10pt; color:#0000FF">
<br>
</span></span><span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000">          TestFiles('*.*');
<br>
        <b>except</b>
<br>
          MessageDlg('Errors occurred in the archive file',mtError,[mbOk],0);
<br>
        <b>end;</b>
<br>
</span><span style="font-family:Helvetica,Arial; font-size:5pt; color:#000000"> 
<br>
</span><span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000">        <span style="font-family:Helvetica,Arial; font-size:10pt; color:#0000FF"><i>// Close the archive</i></span></span><span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000">
<br>
        CloseArchive;
<br>
<b>    end;</b>
<br>

<br>
</span></span>

</body>
</html>
